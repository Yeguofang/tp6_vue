{"remainingRequest":"/Users/yeguofang/www/tp6_vue_10/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yeguofang/www/tp6_vue_10/src/views/cart.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yeguofang/www/tp6_vue_10/src/views/cart.vue","mtime":1579534058000},{"path":"/Users/yeguofang/www/tp6_vue_10/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yeguofang/www/tp6_vue_10/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yeguofang/www/tp6_vue_10/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yeguofang/www/tp6_vue_10/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport header_ from '../components/header_'\nimport footer_ from '../components/footer_'\nimport {cartList, deleteCart, updateCart} from \"../lib/interface\";\n\nexport default {\n    components: {header_, footer_},\n    name: \"cart\",\n    data() {\n        return {\n            list: [],\n            checkAll: false,\n            totalPrice: 0.00,\n            totalCount: 0\n        }\n    },\n    mounted() {\n        $('.to-top').toTop({position: false});\n        // 个数限制输入数字\n        $('input.val').onlyReg({reg: /[^0-9.]/g});\n        this.getTotalSum();\n        this.getResult();\n    },\n    methods: {\n        async getResult() {\n            let result = await cartList();\n            this.list = result.result;\n            for (var i = 0; i < this.list.length; i++) {\n                this.list[i].isCheck = false;\n            }\n        },\n        order() {\n            var ids = \"\";\n            for (var i = 0; i < this.list.length; i++) {\n                if (this.list[i].isCheck === true) {\n                    ids += this.list[i].id + \",\";\n                }\n            }\n            ids = ids.substr(0, ids.length - 1);\n            if (ids.length === 0) {\n                this.$Message.error(\"请选择至少一件商品\");\n                return;\n            }\n            this.$router.push(\"/order?ids=\" + ids);\n        },\n        handleCheckAll() {\n            if (this.checkAll) {\n                this.checkAll = false;\n                for (var i = 0; i < this.list.length; i++) {\n                    this.list[i].isCheck = false\n                }\n            } else {\n                this.checkAll = true;\n                for (var i = 0; i < this.list.length; i++) {\n                    this.list[i].isCheck = true\n                }\n            }\n            this.getTotalSum();\n            this.getTotalCount();\n        },\n        chooseCheck(index) {\n            if (this.list[index].isCheck === false) {\n                this.list[index].isCheck = true;\n            } else {\n                this.list[index].isCheck = false;\n            }\n            this.getTotalSum();\n            this.getTotalCount();\n            this.checkIsAll();\n        },\n        checkIsAll() {\n            var checkAll = true;\n            for (var i = 0; i < this.list.length; i++) {\n                if (this.list[i].isCheck === false) {\n                    checkAll = false;\n                    break;\n                }\n            }\n            this.checkAll = checkAll;\n        },\n        async del(k) {\n            let id = this.list[k].id;\n            let result = await deleteCart({\"id\": id});\n            this.$Message.success(result.message);\n            if (result.code === 1) {\n                this.list.splice(k, 1);\n                this.getTotalSum();\n                this.getTotalCount();\n            }\n        },\n        async changeNum(index, t) {\n            var num = 0;\n            if (t === 1) { //+\n                if (this.list[index].num === 1) {\n                    return;\n                }\n                num = this.list[index].num - 1;\n            } else { // -\n                num = this.list[index].num + 1;\n            }\n            let result = await updateCart({\"id\": this.list[index].id, \"num\": num});\n            if (result.status === 1) {\n                this.getTotalSum();\n                this.getTotalCount();\n                if (t === 1) { //+\n                    this.list[index].num = this.list[index].num - 1;\n                } else { // -\n                    this.list[index].num = this.list[index].num + 1;\n                }\n            } else {\n                this.$Message.error(result.message);\n            }\n        },\n        getTotalSum() {\n            this.totalPrice = 0.00;\n            for (var i = 0; i < this.list.length; i++) {\n                if (this.list[i].isCheck === true) {\n                    this.totalPrice += this.list[i].price * this.list[i].num\n                }\n            }\n            this.totalPrice = this.totalPrice.toFixed(2);\n            console.log(this.totalPrice);\n        },\n        getTotalCount() {\n            this.totalCount = 0;\n            for (var i = 0; i < this.list.length; i++) {\n                if (this.list[i].isCheck === true) {\n                    this.totalCount += parseFloat(this.list[i].num);\n                }\n            }\n            console.log(this.totalCount);\n        }\n    }\n}\n",{"version":3,"sources":["cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmFA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"cart.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div>\n        <!-- 顶部tab -->\n        <header_></header_>\n        <!-- 顶部标题 -->\n        <div class=\"bgf5 clearfix\">\n            <div class=\"top-user\">\n                <div class=\"inner\">\n                    <router-link class=\"logo\" to=\"/\"><img src=\"@/assets/images/icons/logo.jpg\" alt=\"TP6\" class=\"cover\">\n                    </router-link>\n                    <div class=\"title\">购物车</div>\n                </div>\n            </div>\n        </div>\n        <div class=\"content clearfix bgf5\">\n            <section class=\"user-center inner clearfix\">\n                <div class=\"user-content__box clearfix bgf\">\n                    <div class=\"title\">购物车</div>\n                    <div class=\"shopcart-form__box\">\n                        <table class=\"table table-bordered\">\n                            <thead>\n                            <tr>\n                                <th width=\"150\">\n                                    <label class=\"checked-label\">\n                                        <Checkbox\n                                                :value=\"checkAll\"\n                                                @click.prevent.native=\"handleCheckAll\">全选\n                                        </Checkbox>\n                                    </label>\n                                </th>\n                                <th width=\"300\">商品信息</th>\n                                <th width=\"150\">单价</th>\n                                <th width=\"200\">数量</th>\n                                <th width=\"200\">总价</th>\n                                <th width=\"80\">操作</th>\n                            </tr>\n                            </thead>\n                            <tbody>\n                            <tr v-for=\"(v,k) in list\">\n                                <th scope=\"row\">\n                                    <label class=\"checked-label\">\n                                        <Checkbox :value=\"v.isCheck\" @click.prevent.native=\"chooseCheck(k)\"></Checkbox>\n                                        <i></i>\n                                        <div class=\"img\"><img :src=\"v.image\" style=\"width: 100px;height: 100px;\" alt=\"\" class=\"cover\">\n                                        </div>\n                                    </label>\n                                </th>\n                                <td>\n                                    <div class=\"name ep3\" v-text=\"v.title\"></div>\n                                    <div class=\"type c9\" v-text=\"v.sku\"></div>\n                                </td>\n                                <td>¥<span v-text=\"v.price\"></span></td>\n                                <td>\n                                    <div class=\"cart-num__box\">\n                                        <input type=\"button\" class=\"sub\" value=\"-\" @click=\"changeNum(k,1)\">\n                                        <input type=\"text\" class=\"val\" :value=\"v.num\" disabled=\"true\" maxlength=\"2\">\n                                        <input type=\"button\" class=\"add\" value=\"+\" @click=\"changeNum(k,2)\">\n                                    </div>\n                                </td>\n                                <td>¥<span v-text=\"(v.price*v.num).toFixed(2)\"></span></td>\n                                <td><a @click=\"del(k)\">删除</a></td>\n                            </tr>\n                            </tbody>\n                        </table>\n                        <div class=\"user-form-group tags-box shopcart-submit pull-right\">\n                            <button type=\"submit\" class=\"btn\" @click=\"order\">去结算</button>\n                        </div>\n                        <div class=\"checkbox shopcart-total\">\n                            <div class=\"pull-right\">\n                                已选商品 <span v-text=\"totalCount\"></span> 件\n                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;合计（不含运费）\n                                <b class=\"cr\">¥<span class=\"fz24\" v-text=\"totalPrice\"></span></b>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </section>\n        </div>\n        <footer_></footer_>\n    </div>\n</template>\n\n<script>\n    import header_ from '../components/header_'\n    import footer_ from '../components/footer_'\n    import {cartList, deleteCart, updateCart} from \"../lib/interface\";\n\n    export default {\n        components: {header_, footer_},\n        name: \"cart\",\n        data() {\n            return {\n                list: [],\n                checkAll: false,\n                totalPrice: 0.00,\n                totalCount: 0\n            }\n        },\n        mounted() {\n            $('.to-top').toTop({position: false});\n            // 个数限制输入数字\n            $('input.val').onlyReg({reg: /[^0-9.]/g});\n            this.getTotalSum();\n            this.getResult();\n        },\n        methods: {\n            async getResult() {\n                let result = await cartList();\n                this.list = result.result;\n                for (var i = 0; i < this.list.length; i++) {\n                    this.list[i].isCheck = false;\n                }\n            },\n            order() {\n                var ids = \"\";\n                for (var i = 0; i < this.list.length; i++) {\n                    if (this.list[i].isCheck === true) {\n                        ids += this.list[i].id + \",\";\n                    }\n                }\n                ids = ids.substr(0, ids.length - 1);\n                if (ids.length === 0) {\n                    this.$Message.error(\"请选择至少一件商品\");\n                    return;\n                }\n                this.$router.push(\"/order?ids=\" + ids);\n            },\n            handleCheckAll() {\n                if (this.checkAll) {\n                    this.checkAll = false;\n                    for (var i = 0; i < this.list.length; i++) {\n                        this.list[i].isCheck = false\n                    }\n                } else {\n                    this.checkAll = true;\n                    for (var i = 0; i < this.list.length; i++) {\n                        this.list[i].isCheck = true\n                    }\n                }\n                this.getTotalSum();\n                this.getTotalCount();\n            },\n            chooseCheck(index) {\n                if (this.list[index].isCheck === false) {\n                    this.list[index].isCheck = true;\n                } else {\n                    this.list[index].isCheck = false;\n                }\n                this.getTotalSum();\n                this.getTotalCount();\n                this.checkIsAll();\n            },\n            checkIsAll() {\n                var checkAll = true;\n                for (var i = 0; i < this.list.length; i++) {\n                    if (this.list[i].isCheck === false) {\n                        checkAll = false;\n                        break;\n                    }\n                }\n                this.checkAll = checkAll;\n            },\n            async del(k) {\n                let id = this.list[k].id;\n                let result = await deleteCart({\"id\": id});\n                this.$Message.success(result.message);\n                if (result.code === 1) {\n                    this.list.splice(k, 1);\n                    this.getTotalSum();\n                    this.getTotalCount();\n                }\n            },\n            async changeNum(index, t) {\n                var num = 0;\n                if (t === 1) { //+\n                    if (this.list[index].num === 1) {\n                        return;\n                    }\n                    num = this.list[index].num - 1;\n                } else { // -\n                    num = this.list[index].num + 1;\n                }\n                let result = await updateCart({\"id\": this.list[index].id, \"num\": num});\n                if (result.status === 1) {\n                    this.getTotalSum();\n                    this.getTotalCount();\n                    if (t === 1) { //+\n                        this.list[index].num = this.list[index].num - 1;\n                    } else { // -\n                        this.list[index].num = this.list[index].num + 1;\n                    }\n                } else {\n                    this.$Message.error(result.message);\n                }\n            },\n            getTotalSum() {\n                this.totalPrice = 0.00;\n                for (var i = 0; i < this.list.length; i++) {\n                    if (this.list[i].isCheck === true) {\n                        this.totalPrice += this.list[i].price * this.list[i].num\n                    }\n                }\n                this.totalPrice = this.totalPrice.toFixed(2);\n                console.log(this.totalPrice);\n            },\n            getTotalCount() {\n                this.totalCount = 0;\n                for (var i = 0; i < this.list.length; i++) {\n                    if (this.list[i].isCheck === true) {\n                        this.totalCount += parseFloat(this.list[i].num);\n                    }\n                }\n                console.log(this.totalCount);\n            }\n        }\n    }\n</script>\n\n<style scoped>\n\n</style>\n"]}]}